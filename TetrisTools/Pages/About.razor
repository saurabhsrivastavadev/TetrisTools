@page "/about"

@using System.Diagnostics
@using System.Runtime.InteropServices
@using DotNetUtils.Win32.UserActivity
@using System.Reflection
@using GitHubApiUtils

@inject TetrisTools.Services.UserActivityMonitoringService UAM
@inject IGitHubApi GitHubApi

<h2>Tetris Tools</h2>
<br />

<div class="shadow p-3 mb-5 bg-white rounded" style="max-width: 500px;">
    <h4>Release Info</h4>
    <p>
        Current Version - @Version
    </p>
    <p>
        Latest Available Version - @LatestVersion <br/>
        <a href="@LatestVersionUrl" target="_blank">@LatestVersionUrl</a>
    </p>
</div>

<div class="shadow p-3 mb-5 bg-white rounded" style="max-width: 500px;">
    <h4>Contact</h4>
    <p>
        Saurabh Srivastava <br />
        sobu86@outlook.com
    </p>
</div>

@code {

    private string _version;
    private string Version
    {
        get
        {
            if (_version == null)
            {
                _version = Assembly.GetExecutingAssembly().
                            GetCustomAttribute<AssemblyInformationalVersionAttribute>().
                                InformationalVersion;
            }
            return _version;
        }
    }

    private string LatestVersion;
    private string LatestVersionUrl;

    protected override async Task OnInitializedAsync()
    {
        var latestRelease = await GitHubApi.GetLatestRepoRelease("sobu86", "TetrisTools");
        LatestVersion = latestRelease.TagName;
        LatestVersionUrl = latestRelease.HtmlUrl;
        await base.OnInitializedAsync();
    }
}
